if(!window.mainInjectInit){window.mainInjectInit=!0;var storeInformation={nordstrom:{id:"nordstrom",name:"Nordstrom",url:"https://shop.nordstrom.com"},vans:{id:"vans",name:"Vans",url:"https://vans.com"},pacsun:{id:"pacsun",name:"Pacsun",url:"https://pacsun.com"},hollister:{id:"hollister",name:"Hollister",url:"https://hollister.com"},nike:{id:"nike",name:"Nike",url:"https://www.nike.com"},americaneagle:{id:"americaneagle",name:"American Eagle",url:"https://www.ae.com"},adidas:{id:"adidas",name:"Adidas",url:"https://www.adidas.com"},urbanoutfitters:{id:"urbanoutfitters",name:"Urban Outfitters",url:"https://www.urbanoutfitters.com"},victoriassecret:{id:"victoriassecret",name:"Victoria's Secret",url:"https://www.victoriassecret.com"},brandymelville:{id:"brandymelville",name:"Brandy Melville",url:"https://www.brandymelvilleusa.com"},abercrombiefitch:{id:"abercrombiefitch",name:"Abercrombie & Fitch",url:"https://www.abercrombie.com"},hottopic:{id:"hottopic",name:"Hot Topic",url:"https://www.hottopic.com"},oldnavy:{id:"oldnavy",name:"Old Navy",url:"https://oldnavy.gap.com"},zumiez:{id:"zumiez",name:"Zumiez",url:"https://www.zumiez.com"},gap:{id:"gap",name:"Gap",url:"https://www.gap.com"},bananarepublic:{id:"bananarepublic",name:"Banana Republic",url:"https://bananarepublic.gap.com"},jcrew:{id:"jcrew",name:"J.Crew",url:"https://www.jcrew.com"},hm:{id:"hm",name:"H&M",url:"https://www2.hm.com"},bloomingdales:{id:"bloomingdales",name:"Bloomingdale's",url:"https://www.bloomingdales.com"},billabong:{id:"billabong",name:"Billabong",url:"https://www.billabong.com"},nordstromrack:{id:"nordstromrack",name:"Nordstrom Rack",url:"https://www.nordstromrack.com"},northface:{id:"northface",name:"North Face",url:"https://www.thenorthface.com"},levis:{id:"levis",name:"Levi's",url:"https://www.levi.com"},champion:{id:"champion",name:"Champion",url:"https://www.champion.com"},pink:{id:"pink",name:"PINK",url:"https://www.victoriassecret.com/pink"},guess:{id:"guess",name:"Guess",url:"https://shop.guess.com"},asos:{id:"asos",name:"ASOS",url:"https://www.asos.com"},target:{id:"target",name:"Target",url:"https://www.target.com"},hugoboss:{id:"hugoboss",name:"Hugo Boss",url:"https://www.hugoboss.com"}};async function productInfoAbercrombieFitch(){let t="",e="";console.log($(".breadcrumb-container .breadcrumbs-link").text()),$(".breadcrumb-container .breadcrumbs-link").text().toLowerCase().includes("womens")?e="Womens":$(".breadcrumb-container .breadcrumbs-link").text().toLowerCase().includes("mens")&&(e="Mens"),t+=" "+e,t+=$(".product-swatches .selected .product-attrs__shown-in span").text().replace("Shown in",""),t+=$(".product-page__swatches-attributes .product-attrs__shown-in.selected-swatch__label").text().replace("Shown in",""),t+=" "+$(".product-title-main-header").text(),t=(t+=$(".short-description").text()).toLowerCase(),console.log(t);const r=await fetch(chrome.runtime.getURL("/src/keywords.json")),i=await r.json(),s={searchStores:[storeInformation.hollister.id,storeInformation.urbanoutfitters.id,storeInformation.abercrombiefitch.id],url:window.location.href,search:getSearchKeywords(t,i),string:t};console.log(s),getProducts(s)}async function getNordstromProducts(t){const e=[];return await $.get(`https://shop.nordstrom.com/sr?origin=keywordsearch&keyword=${t.join("+").replace(/ /g,"+")}`,function(t){$(t).find("._1AOd3").each(function(){const t={name:$(this).find("._5lXiG ").text(),price:$(this).find("._3bi0z ._3wu-9").text().split("$")[1].replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:$(this).find("._18N5Q").length>0&&$(this).find("._18N5Q ._3wu-9").text().split("$")[1].replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),img:$(this).find(".TDd9E").attr("src"),link:`https://shop.nordstrom.com${$(this).find("._1av3_").attr("href")}`.split("?origin")[0],storeName:"Nordstrom"};t.price=t.price.replace(/\u2013/g,""),e.push(t)})}),e}async function getHugoBossProducts(t){const e=[];return await $.get(`https://www.hugoboss.com/us/search?q=${t.join("%20").replace(/ /g,"%20")}`,function(t){$(t).find(".search-result-content .search-result-items__grid-tile").each(function(){const t={name:$(this).find(".product-tile__productInfoWrapper").text().replace(/BOSS|HUGO|by|(\r\n|\n|\r)/gm,""),price:$(this).find(".product-tile__offer .price-sales.price-sales--red").length>0?$(this).find(".product-tile__offer .price-standard s").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""):$(this).find(".product-tile__offer .price-sales").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:$(this).find(".product-tile__offer .price-sales.price-sales--red").length>0&&$(this).find(".product-tile__offer .price-sales.price-sales--red").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),img:$(this).find(".product-tile__image").attr("data-src").replace(/({width})/g,"240").replace(/({quality})/g,"45"),link:`https://www.hugoboss.com${$(this).find(".product-tile__link").attr("data-url")}`,storeName:"Hugo Boss"};e.push(t)})}),e}async function getPacsunProducts(t){const e=[];try{await $.get(`https://www.pacsun.com/on/demandware.store/Sites-pacsun-Site/default/Search-Show?stype=snap&etype=submit&q=${t.join("%20").replace(/ /g,"%20")}`,function(t){$(t).find("#primary .product-tile").each(function(){const t={name:$(this).find(".product-name .name-link").text().replace(/(\r\n|\n|\r)/gm,""),price:$(this).find(".price-standard").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:$(this).find(".price-promo").length>0&&$(this).find(".price-promo").text().replace(/(\t|\r\n|\n|\r)|[$| |,]|Now/gm,""),img:$(this).find(".product-image img").attr("src"),link:$(this).find(".product-name .name-link").attr("href"),storeName:"Pacsun"};e.push(t)})})}catch(t){throw t}return e}async function getHollisterProducts(t){console.log(t);const e=[];return await $.get(`https://www.hollisterco.com/shop/us/search?departmentCategoryId=10006&searchTerm=${t.join("+").replace(/ /g,"+")}`,function(t){$(t).find(".products-container .product-card--hol").each(function(){const t={name:$(this).find(".product-card__name").text().replace(/(\r\n|\n|\r)/gm,""),price:$(this).find('.product-price-text[data-state="discount"]').length>0?$(this).find('.product-price-text[data-state="original"]').text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""):$(this).find(".product-price-text").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:$(this).find('.product-price-text[data-state="discount"]').length>0&&$(this).find('.product-price-text[data-state="discount"]').text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),img:$(this).find(".product-card__image-wrap .product-card__image").attr("data-src").replace("imageType","prod1"),link:"https://www.hollisterco.com"+$(this).find(".product-card__name").attr("href"),storeName:"Hollister"};e.push(t)})}),e}async function getVansProducts(t){const e=[];return await $.get(`https://www.vans.com/webapp/wcs/stores/servlet/VFSearchDisplay?storeId=10153&catalogId=10703&langId=-1&beginIndex=0&searchSource=Q&sType=SimpleSearch&searchTerm=${t.join("+").replace(/ /g,"+")}`,function(t){$(t).find("#catalog-results .product-block").each(function(){const t={name:$(this).find(".product-block-name-wrapper").text().replace(/(\r\n|\n|\r)/gm,""),price:$(this).find(".product-block-price").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),img:$(this).find(".product-block-views-selected-view-main-image").attr("srcset").replace("//","https://"),link:$(this).find(".product-block-name-link").attr("href"),storeName:"Vans"};e.push(t)})}),e}async function getNikeProducts(t){const e=[];return await $.get(`https://www.nike.com/w?q=${t.join("%20").replace(/ /g,"%20")}&vst=${t.join("%20").replace(/ /g,"%20")}`,function(t){$(t).each(function(){if($(this).html()&&$(this).html().toString().startsWith("window.INITIAL_REDUX_STATE=")){JSON.parse($(this).html().toString().replace(/(\t|\r\n|\n|\r)|;|window.INITIAL_REDUX_STATE=/gm,"")).Wall.products.forEach(t=>{const r={name:t.title.replace(/(\r\n|\n|\r)/gm,"")+" "+t.subtitle,price:t.price.fullPrice,sale:!!t.price.discounted&&t.currentPrice,link:t.url.replace("{countryLang}","https://nike.com"),img:t.image,storeName:"Nike"};e.push(r)})}})}),e}async function getAmericanEagleProducts(t){const e=[];return await $.get(`https://www.ae.com/s/${t.join("+").replace(/ /g,"+")}`,function(t){$(t).find(".search-products .product-tile").each(function(){const t={name:$(this).find(".product-name").text().replace(/(\r\n|\n|\r)/gm,""),price:$(this).find(".product-list-price").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:$(this).find(".product-sale-price").length>0&&$(this).find(".product-sale-price").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),img:`https://s7d2.scene7.com/is/image/aeo/${$(this).attr("data-product-id")}_f?$cat-main_large$`,link:"https://www.ae.com/"+$(this).find(".tile-link").attr("href").split("?nvid")[0],storeName:"American Eagle"};e.push(t)})}),e}async function getAdidasProducts(t){return await(()=>{let e=[];return new Promise(r=>{$.get(`https://www.adidas.com/api/search/tf/query?sitePath=us&query=${t.join("+").replace(/ /g,"+")}`,function(t){t.itemList.items.forEach(async(i,s)=>{const a={name:i.displayName,link:"https://www.adidas.com"+i.link,img:i.image.src,storeName:"Adidas"};let n=await(t=>new Promise(e=>{fetch(`https://www.adidas.com/api/search/product/${t}`).then(t=>{e(t.json())})}))(i.productId);a.price=n.price,a.sale=n.price!==n.salePrice&&n.salePrice,e.push(a),t.itemList.items.length==s+1&&r(e)})})})})()}async function getUrbanOutfittersProducts(t){const e=[];return console.log(t),console.log(`https://www.urbanoutfitters.com/search?q=${t.join("+").replace(/ /g,"+")}`),await $.get(`https://www.urbanoutfitters.com/search?q=${t.join("+").replace(/ /g,"+")}`,function(t){console.log(t);let r=$(t).find(".c-pwa-tile-tiles .c-pwa-tile-grid-inner");console.log($(t).find(".c-pwa-tile-view-outer")),console.log($(t)),r.each(function(){console.log($(this));const t={name:$(this).find(".c-pwa-product-tile__heading").text().replace(/(\r\n|\n|\r)|  /gm,""),price:$(this).find(".c-pwa-product-price__original").length>0?$(this).find(".c-pwa-product-price__original").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""):$(this).find(".c-pwa-product-price__current").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:$(this).find(".c-pwa-product-price__original").length>0&&$(this).find(".c-pwa-product-price__current").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),img:`http://s7d5.scene7.com/is/image/UrbanOutfitters/${$(this).find('.c-pwa-swatch__input[name="selectedColor"]').attr("id").split("_")[0]}_${$(this).find('.c-pwa-swatch__input[name="selectedColor"]').attr("value")}_d?$medium$&qlt=80&fit=constrain`,link:"https://www.urbanoutfitters.com"+$(this).find(".c-pwa-product-tile__link").attr("href").split("?category")[0],storeName:"Urban Outfitters"};e.push(t)})}),console.log("urban",e),e}async function getVictoriaSecretProducts(t){const e=[];return t.includes("men")?[]:(await $.get(`https://api.victoriassecret.com/keywordsearch/v4/search?brand=vs&q=${t.join("%20").replace(/ /g,"%20")}&searchLocation=header`,function(t){t.products.forEach(t=>{const r={name:t.name.replace(/(\r\n|\n|\r)|  /gm,""),price:t.price.replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:!!t.salePrice&&t.salePrice.replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),img:"https://www.victoriassecret.com/p/220x293/"+t.productImages[0]+".jpg",link:t.url.split("?")[0],storeName:"Victoria's Secret"};e.push(r)})}),e)}async function getBrandyMelvilleProducts(t){const e=[];return t.includes("men")?[]:(await $.get(`https://www.brandymelvilleusa.com/catalogsearch/result/?q=${t.join("+").replace(/ /g,"+")}`,function(t){$(t).find(".category-products .product-item").each(function(){const t={name:$(this).find(".product-item-name").find("a").text().replace(/(\r\n|\n|\r)|  /gm,""),price:$(this).find(".price").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:!1,img:$(this).find(".product-item-image a img").first().attr("src"),link:$(this).find(".quickViewContainer").attr("href"),storeName:"Brandy Melville"};e.push(t)})}),e)}async function getAbercrombieFitchProducts(t){const e=[];return await $.get(`https://www.abercrombie.com/shop/us/search?departmentCategoryId=10000&searchTerm=${t.join("+").replace(/ /g,"+")}`,function(t){if($(t).find(".rs-search-detail__additional-info").text().toLowerCase().replace(/(\r\n|\n|\r)|  /gm,"").includes("no match found"))return;$(t).find(".search-grid .product-card--anf").each(function(){const t={name:$(this).find(".product-card__name").text().replace(/(\r\n|\n|\r)/gm,""),price:$(this).find('.product-price-text[data-state="discount"]').length>0?$(this).find('.product-price-text[data-state="original"]').text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""):$(this).find(".product-price-text").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:$(this).find('.product-price-text[data-state="discount"]').length>0&&$(this).find('.product-price-text[data-state="discount"]').text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),img:$(this).find(".product-card__image").attr("data-src").replace("imageType","prod1"),link:"https://www.abercrombie.com"+$(this).find(".product-card__image-link").attr("href"),storeName:"Abercrombie & Fitch"};e.push(t)})}),e}async function getHotTopicProducts(t){const e=[];return await $.get(`https://www.hottopic.com/search?q=${t.join("+").replace(/ /g,"+")}`,function(t){$(t).find("#search-result-items .grid-tile").each(function(){const t={name:$(this).find(".name-link").text().replace(/(\r\n|\n|\r)/gm,""),price:(($(this).find(".price-sales").length>0?$(this).find(".price-original").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""):$(this).find(".price-standard").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""))||$(this).find(".product-discounted-price").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,"")).split("-")[0],sale:$(this).find(".price-sales").length>0&&$(this).find(".price-sales").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,"").split("-")[0],img:$(this).find(".first-image").attr("src"),link:$(this).find(".name-link").attr("href"),storeName:"Hot Topic"};e.push(t)})}),e}async function getOldNavyProducts(t){const e=[];return await $.get(`https://brm-core-0.brsrvr.com/api/v1/core/?account_id=6063&auth_key=&domain_key=oldnavy&request_id=2803065648391&_br_uid_2=uid%3D3953529282324%3Av%3D12.0%3Ats%3D1574719946739%3Ahc%3D5&url=https://oldnavy.gap.com/index.html%23brm-search%3Frequest_type=search&search_type=keyword&q=${t.join("%20").replace(/ /g,"%20")}&l=${t.join("%20").replace(/ /g,"%20")}&br_origin=searchbox&realm=prod&ref_url=https://oldnavy.gap.com/&request_type=search&rows=200&start=0&facet.limit=300&fl=pid,title,brand,price,sale_price,price_type,promotions,thumb_image,sku_thumb_images,sku_swatch_images,sku_color_group,url,price_range,sale_price_range,description,is_live,score,defaultColorMarketingMessage,styleMarketingMessage&stats.field=sale_price`,function(t){t.response.docs.forEach(t=>{const r={name:t.title,price:t.price,sale:t.price!=t.sale_price_range[0]&&t.sale_price_range[0],img:`https://oldnavy.gap.com/${t.thumb_image}`,link:`https://oldnavy.gap.com/${t.url}`,storeName:"Old Navy"};e.push(r)})}),e}async function getZumiezProducts(t){const e=[];return await $.get(`https://www.zumiez.com/catalogsearch/result/?q=${t.join("+").replace(/ /g,"+")}&kw=${t.join("+").replace(/ /g,"+")}`,function(t){$(t).find(".category-products .column.item").each(function(){const t={name:$(this).find(".product-name").text().replace(/(\r\n|\n|\r)/gm,""),price:$(this).find(".price").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:$(this).find(".sale-price").length>0&&$(this).find(".sale-price").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),img:$(this).find(".product-image img").attr("src"),link:$(this).find(".product-image").attr("href"),storeName:"Zumiez"};e.push(t)})}),e}async function getGapProducts(t){const e=[];return await $.get(`https://brm-core-0.brsrvr.com/api/v1/core/?account_id=5468&auth_key=&domain_key=gap&request_id=2803065648391&_br_uid_2=uid%3D3953529282324%3Av%3D12.0%3Ats%3D1574719946739%3Ahc%3D11&url=https://www.gap.com/index.html%23brm-search%3Frequest_type=search&search_type=keyword&q=${t.join("%20").replace(/ /g,"%20")}&l=${t.join("%20").replace(/ /g,"%20")}&br_origin=searchbox&realm=prod&ref_url=https://www.gap.com/&request_type=search&rows=200&start=0&facet.limit=300&fl=pid,title,brand,price,sale_price,price_type,promotions,thumb_image,sku_thumb_images,sku_swatch_images,sku_color_group,url,price_range,sale_price_range,description,is_live,score,defaultColorMarketingMessage,styleMarketingMessage&stats`,function(t){t.response.docs.forEach(t=>{const r={name:t.title,price:t.price,sale:t.price!=t.sale_price_range[0]&&t.sale_price_range[0],img:`https://gap.com/${t.thumb_image}`,link:`https://gap.com/${t.url}`,storeName:"Gap"};e.push(r)})}),e}async function getBananaRepublicProducts(t){const e=[];return await $.get(`https://brm-core-0.brsrvr.com/api/v1/core/?account_id=6105&auth_key=&domain_key=bananarepublic&request_id=2803065648391&_br_uid_2=uid%3D3953529282324%3Av%3D12.0%3Ats%3D1574719946739%3Ahc%3D14&url=https://bananarepublic.gap.com/index.html%23brm-search%3Frequest_type=search&search_type=keyword&q=${t.join("%20").replace(/ /g,"%20")}&l=${t.join("%20").replace(/ /g,"%20")}&br_origin=searchbox&realm=prod&ref_url=https://bananarepublic.gap.com/&request_type=search&rows=200&start=0&facet.limit=300&fl=pid,title,brand,price,sale_price,price_type,promotions,thumb_image,sku_thumb_images,sku_swatch_images,sku_color_group,url,price_range,sale_price_range,description,is_live,score,defaultColorMarketingMessage,styleMarketingMessage&stats.field=sale_price`,function(t){t.response.docs.forEach(t=>{const r={name:t.title,price:t.price,sale:t.price!=t.sale_price_range[0]&&t.sale_price_range[0],img:`https://bananarepublic.gap.com/${t.thumb_image}`,link:`https://bananarepublic.gap.com/${t.url}`,storeName:"Banana Republic"};e.push(r)})}),e}async function getJCrewProducts(t){const e=[];return await $.get(`https://www.jcrew.com/r/search/?N=0&Nloc=en&Ntrm=${t.join("%20").replace(/ /g,"%20")}&Nsrt=&Npge=1&Nrpp=60`,function(t){$(t).find(".product__list .c-product-tile").each(function(){const t={name:$(this).find(".tile__detail--name").text().replace(/(\r\n|\n|\r)/gm,""),price:$(this).find(".tile__detail--price--sale--old").length>0?$(this).find(".tile__detail--price--was span").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""):$(this).find(".tile__detail--price span").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:$(this).find(".tile__detail--price--sale--old").length>0&&$(this).find(".tile__detail--price--sale--old span").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),img:`https://www.jcrew.com/s7-img-facade/${$(this).find(".product-tile").attr("class").split(" ")[1].split("-")[1]}?fmt=jpeg&qlt=90,0&resMode=sharp&op_usm=.1,0,0,0&crop=0,0,0,0&wid=480&hei=480`,link:"https://www.jcrew.com"+$(this).find(".product-tile__link").attr("href"),storeName:"J.Crew"};e.push(t)})}),e}async function getHMProducts(t){const e=[];return await $.get(`https://www2.hm.com/en_us/search-results.html?q=${t.join("+").replace(/ /g,"+")}`,function(t){$(t).find(".products-listing .product-item").each(function(){const t={name:$(this).find(".item-heading a").text().replace(/(\r\n|\n|\r)/gm,""),price:$(this).find(".price.regular").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:$(this).find(".price.sale").length>0&&$(this).find(".price.sale").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),img:$(this).find(".item-image").attr("data-src").replace("//","https://"),link:"https://www2.hm.com"+$(this).find(".item-heading a").attr("href"),storeName:"H&M"};e.push(t)})}),e}async function getBloomingDaleProducts(t){const e=[];return await $.get(`https://www.bloomingdales.com/shop/search?keyword=${t.join("+").replace(/ /g,"+")}`,function(t){$(t).find(".items .productThumbnail").each(function(){const t={name:$(this).find(".primary-image img").attr("alt").replace(/(\r\n|\n|\r)/gm,""),price:$(this).find(".tnPrice .regular").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:$(this).find(".tnPrice .discount").length>0&&$(this).find(".tnPrice .discount").text().split("$")[1].split(" ")[0].replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),img:$(this).find(".primary-image img").attr("src")||$(this).find(".primary-image img").attr("data-lazysrc"),link:"https://www.bloomingdales.com"+$(this).find(".productDescLink").attr("href"),storeName:"Bloomingdale's"};e.push(t)})}),e}async function getBillabongProducts(t){const e=[];return await $.get(`https://www.billabong.com/search/?q=${t.join("+").replace(/ /g,"+")}`,function(t){$(t).find("#productssearchresult .producttile").each(function(){const t={name:$(this).find(".name a").text().replace(/(\r\n|\n|\r)/gm,""),price:"-"!=$(this).find(".price.data-price").attr("data-standardprice")?$(this).find(".price.data-price").attr("data-standardprice").replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""):$(this).find(".price.data-price").attr("data-salesprice").replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:"-"!=$(this).find(".price.data-price").attr("data-standardprice")&&$(this).find(".price.data-price").attr("data-salesprice").replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),img:$(this).find(".productimage img").attr("src"),link:$(this).find(".name a").attr("href"),storeName:"Billabong"};e.push(t)})}),e}async function getNordstromRackProducts(t){const e=[];return await $.get(`https://www.nordstromrack.com/api/search2/catalog/search?includeFlash=true&includePersistent=true&limit=99&page=1&query=${t.join("%20").replace(/ /g,"%20")}&sort=relevancy&nestedColors=false&site=nordstromrack`,function(t){t._embedded["http://hautelook.com/rels/products"].forEach(t=>{const r={name:t.name,price:t._embedded["http://hautelook.com/rels/skus"][0].price_retail,sale:t._embedded["http://hautelook.com/rels/skus"][0].price_discount>0&&t._embedded["http://hautelook.com/rels/skus"][0].price_sale,img:t._embedded["http://hautelook.com/rels/skus"][0]._links["http://hautelook.com/rels/images"][0].href.replace("{size}","large").replace("{width}","228").replace("{height}","350"),link:"https://www.nordstromrack.com/shop/product/"+t.style_id+"?"+t._links.self.href.split("?")[1],storeName:"Nordstrom Rack"};e.push(r)})}),e}async function getNorthFaceProducts(t){const e=[];return await $.get(`https://www.thenorthface.com/shop/VFSearchDisplay?catalogId=20001&storeId=7001&langId=-1&searchTerm=${t.join("+").replace(/ /g,"+")}`,function(t){$(t).find("#catalog-results .product-block").each(function(){const t={name:$(this).find(".product-block-name-wrapper").text().replace(/(\r\n|\n|\r)/gm,""),price:$(this).find(".product-block-price.original-price").length>0?$(this).find(".product-block-price.original-price").attr("data-amount"):$(this).find(".product-block-price").attr("data-amount"),sale:$(this).find(".product-block-price.original-price").length>0&&$(this).find(".product-block-price.current-price").attr("data-amount"),img:$(this).find(".product-block-views-selected-view-main-image").first().attr("srcset").replace("//","https://"),link:$(this).find(".product-block-pdp-url").attr("href"),storeName:"North Face"};e.push(t)})}),e}async function getLeviProducts(t){const e=[];return await $.get(`https://www.levi.com/US/en_US/search/${t.join("%20").replace(/ /g,"%20")}`,function(t){$(t).find(".product__listing .product-item").each(function(){const t={name:$(this).find(".thumb-link").attr("title").replace(/(\r\n|\n|\r)/gm,""),price:$(this).find(".price .regular").text().split("-")[0].replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:($(this).find(".price .hard-sale").length>0||$(this).find(".price .soft-sale").length>0)&&($(this).find(".price .hard-sale").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,"")||$(this).find(".price .soft-sale").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,"")),img:$(this).find(".thumb-link source").first().attr("data-srcset")||$(this).find(".thumb-link source").first().attr("srcset"),link:"https://www.levi.com"+$(this).find(".thumb-link").attr("href"),storeName:"Levi's"};e.push(t)})}),e}async function getLouisVuittonProducts(t){const e=[];return await $.get(`https://us.louisvuitton.com/eng-us/search/${t.join("%20").replace(/ /g,"%20")}`,function(t){$(t).find(".productsList .productItem").each(function(){const t={name:$(this).find(".productName").text().replace(/(\r\n|\n|\r)/gm,""),price:$(this).find(".productPrice .notCrawlableContent").attr("data-htmlContent").replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:!1,img:$(this).find(".product-img source").attr("data-src").replace("{IMG_WIDTH}","1600").replace("{IMG_HEIGHT}","1600"),link:"https://us.louisvuitton.com"+$(this).find(".productCTA").attr("href"),storeName:"Louis Vuitton"};e.push(t)})}),e}async function getChampionProducts(t){const e=[];return await $.get("https://www.champion.com/shop/SearchDisplay?categoryId=411552&doorId=3&storeId=10704&catalogId=11053&langId=-1&sType=SimpleSearch&resultCatEntryType=2&showResultsPage=true&searchSource=Q&pageView=&beginIndex=0&pageSize=20&searchTerm=hoodie#facet:&productBeginIndex:0&orderBy:&pageView:grid&minPrice:&maxPrice:&pageSize:20&",function(t){$(t).find(".product-search-result-container .each-product").each(function(){$(this).find(".visuallyhidden").remove();const t={name:$(this).find(".item-name").text().replace(/(\r\n|\n|\r)/gm,""),price:$(this).find(".list_price").text().trim().length>0&&$(this).find(".current_price").text().trim().length>0?$(this).find(".list_price").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""):$(this).find(".current_price").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:$(this).find(".list_price").text().trim().length>0&&$(this).find(".current_price").text().trim().length>0&&$(this).find(".current_price").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),img:$(this).find(".product-listing-image").attr("data-src"),link:$(this).find(".link-image-holder").attr("href").split("?")[0],storeName:"Champion"};e.push(t)})}),e}async function getPinkProducts(t){const e=[];return t.includes("men")?[]:(await $.get(`https://api.victoriassecret.com/keywordsearch/v4/search?brand=pink&q=${t.join("%20").replace(/ /g,"%20")}&searchLocation=header`,function(t){t.products.forEach(t=>{const r={name:t.name.replace(/(\r\n|\n|\r)|  /gm,""),price:t.price.replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:!!t.salePrice&&t.salePrice.replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),img:"https://www.victoriassecret.com/p/220x293/"+t.productImages[0]+".jpg",link:t.url.split("?")[0],storeName:"Victoria's Secret"};e.push(r)})}),e)}async function getGuessProducts(t){const e=[];return await $.get(`https://recs.richrelevance.com/rrserver/api/find/v1/199c81c05e473265?findCallType=overlay&lang=en&log=true&placement=search_page.find&query=${t.join("+").replace(/ /g,"+")}&rcs=eF5j4cotK8lM4TOzMNU11DVkKU32MEwyNjVNMzPTTUq2NNU1MTY20bU0SzTVNTIwTbIwT0lKSjRNAgB-_g4I&region=undefined&rows=24&sessionId=d8cf1765-d197-46b9-9d1e-6ff0d9bb5a14&ssl=true&start=48`,function(t){t.placements[0].docs.forEach(t=>{const r={name:t.name.replace(/(\r\n|\n|\r)/gm,""),price:t.priceCents/100,sale:-1!=t.salePriceCents&&t.salePriceCents/100,img:t.imageId,link:"https://shop.guess.com"+t.linkId,storeName:"Guess"};e.push(r)})}),e}async function getAsosProducts(t){const e=[];return await $.get(`https://www.asos.com/us/search/?q=${t.join("+").replace(/ /g,"+")}`,function(t){$(t).find("._3-pEc3l ._2oHs74P").each(function(){const t={name:$(this).find("._10-bVn6 p").text().replace(/(\r\n|\n|\r)/gm,""),price:$(this).find("._3b3kqA8").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),sale:$(this).find("._2ZHtSZZ").length>0&&$(this).find("._2ZHtSZZ").text().replace(/(\t|\r\n|\n|\r)|[$| |,]/gm,""),img:$(this).find("._9n6j7z7 img").attr("srcset").split(",")[0].replace("//","https://"),link:$(this).find("._3x-5VWa").attr("href").split("&")[0],storeName:"ASOS"};e.push(t)})}),e}async function getTargetProducts(t){const e=[];return await $.get(`https://redsky.target.com/v2/plp/search/?channel=web&count=24&default_purchasability_filter=true&facet_recovery=false&isDLP=false&keyword=${t.join("+").replace(/ /g,"+")}&offset=0&pageId=%2Fs%2F${t.join("+").replace(/ /g,"+")}&pricing_store_id=1122&scheduled_delivery_store_id=1122&store_ids=1122%2C321%2C1054%2C3265%2C2185&visitorId=016E9B667F74020198F0BF97718A7F1F&include_sponsored_search_v2=true&ppatok=AOxT33a&platform=desktop&useragent=Mozilla%2F5.0+%28Macintosh%3B+Intel+Mac+OS+X+10_14_5%29+AppleWebKit%2F537.36+%28KHTML%2C+like+Gecko%29+Chrome%2F78.0.3904.108+Safari%2F537.36&key=eb2551e4accc14f38cc42d32fbc2b2ea`,function(t){t.search_response.items.Item.forEach(t=>{const r={name:t.title.replace(/(\t|\r\n|\n|\r)|&#174|;/gm,""),price:t.price.reg_retail_min,img:t.images[0].base_url+t.images[0].primary,link:"https://www.target.com"+t.url,storeName:"Target"};e.push(r)})}),e}let allProducts=void 0;function getSearchKeywords(t,e){const r=[];return e.gender.some(e=>{if(t.includes(e))return r.push({word:e,type:"gender"}),!0}),e.color.some(e=>{let i=!1;if(e.word.some(s=>{if(t.includes(s))return i=!0,r.push({word:e.pointToDifferentWord?e.similarTo:s,type:"color"}),!0}),i)return!0}),e.material.some(e=>{if(t.includes(e))return r.push({word:e,type:"material"}),!0}),e.pattern.some(e=>{if(t.includes(e))return r.push({word:e,type:"pattern"}),!0}),e.descriptor.some(e=>{if(t.includes(e))return r.push({word:e,type:"descriptor"}),!0}),e.bannedWords.some(e=>{if(t.includes(e))return r.push({word:"",type:"banned"}),!0}),e.type.some(e=>{let i=!1;if(e.word.some(s=>" "===s[0]&&t.includes(s)?(i=!0,r.push({word:e.pointToDifferentWord?e.similarTo:s,type:"type"}),!0):t.includes(s||s.replace(/ /g,"")||s.replace(/ /,"-"))?(i=!0,r.push({word:e.pointToDifferentWord?e.similarTo:s,type:"type"}),!0):void 0),i)return!0}),{string:r.map(t=>t.word),keywords:e,info:r}}const updateProducts=t=>new Promise((e,r)=>{chrome.storage.sync.get(["favorites"],r=>{let i=r.favorites?r.favorites:[];i.length<1&&e(t),i=i.map(t=>t.link),t.forEach(t=>{i.includes(t.link)?t.favorite=!0:t.favorite=!1}),e(t)})}),appendNotification=t=>{t&&($(".markdown-loading-items-notification").remove(),$("body").append(`\n    <div class="markdown-similar-item-notification">\n      <div class="markdown-logo"></div>\n      <p class="markdown-notification-msg">We found <span>${t.length}</span> clothing items related to what you're looking at.</p>\n      <div class="markdown-close-btn"></div>\n    </div>\n  `))},compareFavoritesToProducts=t=>new Promise((e,r)=>{chrome.storage.sync.get(["favorites"],r=>{let i=r.favorites?r.favorites:[];i.length<1&&e(t),i=i.map(t=>t.link),t.forEach(t=>{i.includes(t.link)?t.favorite=!0:t.favorite=!1}),e(t)})}),sortProducts=(t,e,r)=>{let i=[];return t.forEach(t=>{t.forEach(t=>{i.push(t)})}),i.forEach((t,r)=>{let i=0;e.split(" ").forEach(e=>{t.name.toLowerCase().includes(e.toLowerCase())&&i++}),t.productSimilarity=i}),i.filter(t=>t.productSimilarity>0),i.sort((t,e)=>e.productSimilarity-t.productSimilarity),i};async function searchSimilarStores(t){let e=[],r=t.search.info.filter(t=>"type"===t.type).length<=0,i=t.search.info.filter(t=>"type"===t.type).length>1,s=t.search.info.filter(t=>"banned"===t.type).length>0,a=t.search.info.filter(t=>"color"===t.type).length<=0;return console.log(t),console.log(r,i,s,a),r?[]:i?[]:a?[]:s?[]:(t.searchStores.includes("nordstrom")&&e.push(await getNordstromProducts(t.search.string)),t.searchStores.includes("hugoboss")&&e.push(await getHugoBossProducts(t.search.string)),t.searchStores.includes("pacsun")&&e.push(await getPacsunProducts(t.search.string)),t.searchStores.includes("hollister")&&e.push(await getHollisterProducts(t.search.string)),t.searchStores.includes("vans")&&e.push(await getVansProducts(t.search.string)),t.searchStores.includes("nike")&&e.push(await getNikeProducts(t.search.string)),t.searchStores.includes("americaneagle")&&e.push(await getAmericanEagleProducts(t.search.string)),t.searchStores.includes("adidas")&&e.push(await getAdidasProducts(t.search.string)),t.searchStores.includes("urbanoutfitters")&&e.push(await getUrbanOutfittersProducts(t.search.string)),t.searchStores.includes("victoriassecret")&&e.push(await getVictoriaSecretProducts(t.search.string)),t.searchStores.includes("brandymelville")&&e.push(await getBrandyMelvilleProducts(t.search.string)),t.searchStores.includes("abercrombiefitch")&&e.push(await getAbercrombieFitchProducts(t.search.string)),t.searchStores.includes("oldnavy")&&e.push(await getOldNavyProducts(t.search.string)),t.searchStores.includes("zumiez")&&e.push(await getZumiezProducts(t.search.string)),t.searchStores.includes("gap")&&e.push(await getGapProducts(t.search.string)),t.searchStores.includes("bananarepublic")&&e.push(await getBananaRepublicProducts(t.search.string)),t.searchStores.includes("jcrew")&&e.push(await getJCrewProducts(t.search.string)),t.searchStores.includes("hm")&&e.push(await getHMProducts(t.search.string)),t.searchStores.includes("bloomingdales")&&e.push(await getBloomingDaleProducts(t.search.string)),t.searchStores.includes("billabong")&&e.push(await getBillabongProducts(t.search.string)),t.searchStores.includes("nordstromrack")&&e.push(await getNordstromRackProducts(t.search.string)),t.searchStores.includes("northface")&&e.push(await getNorthFaceProducts(t.search.string)),t.searchStores.includes("levis")&&e.push(await getLeviProducts(t.search.string)),t.searchStores.includes("champion")&&e.push(await getChampionProducts(t.search.string)),t.searchStores.includes("pink")&&e.push(await getPinkProducts(t.search.string)),t.searchStores.includes("guess")&&e.push(await getGuessProducts(t.search.string)),t.searchStores.includes("asos")&&e.push(await getAsosProducts(t.search.string)),t.searchStores.includes("target")&&e.push(await getTargetProducts(t.search.string)),e=await sortProducts(e,t.string,t.search.keywords),e=await compareFavoritesToProducts(e))}async function getPageData(){if(allProducts&&allProducts.length>0)return await updateProducts(allProducts);const storesRes=await fetch(chrome.runtime.getURL("/src/stores.json")),keywordsRes=await fetch(chrome.runtime.getURL("/src/keywords.json")),keywords=await keywordsRes.json(),stores=await storesRes.json();let store="";stores.forEach(t=>{window.location.host.includes(t.url)&&(store=t)}),console.log(store.getInfoFunction),await eval(store.getInfoFunction)}async function getProducts(t){let e=await searchSimilarStores(t);allProducts=e,appendNotification(e)}chrome.runtime.onMessage.addListener((t,e,r)=>{if("popup"===t.from&&"getProducts"===t.subject)return updateProducts(allProducts).then(r),!0}),$(()=>{$(document).on("click",".markdown-close-btn",function(){const t=$(this).parent();t.addClass("slide-out"),setTimeout(()=>{t.remove()},400)});const t=async()=>{const t=await fetch(chrome.runtime.getURL("/src/stores.json"));let e=(await t.json()).filter(t=>{if(window.location.host.toLowerCase().includes(t.url.toLowerCase()))return t});return await e.length>0},e=async()=>{const t=await fetch(chrome.runtime.getURL("/src/stores.json"));let e=(await t.json()).filter(t=>{if(window.location.host.toLowerCase().includes(t.url.toLowerCase()))return t});return!(e.length<=0)&&$(e[0].productPageIdentifier).length>0};(async()=>{await t()&&await e()&&(getPageData(),$("body").append('\n      <div class="markdown-loading-items-notification">\n        <div class="loader"><div class="loader-runner"></div></div>\n        <div class="markdown-logo"></div>\n        <p class="markdown-notification-msg">Finding Similar Items</p>\n        <div class="markdown-close-btn"></div>\n      </div>\n    '))})(),chrome.runtime.onMessage.addListener((r,i,s)=>{if("popup"===r.from&&"getPageStatus"===r.subject)return(async()=>await t()?await e()?{status:"processing"}:{status:"not product page"}:{status:"not store page"})().then(s),!0})})}